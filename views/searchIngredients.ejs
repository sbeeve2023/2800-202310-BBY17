<%- include('templates/header') -%>
    <p>Enter each ingredient individually</p>
    <form>
        <input id="ingredient" type="text" name="search" placeholder="Enter an ingredient" />
        <input type="button" value="Search" id="addBtn"/>
    </form>
    <div id="list" style="display: flex; justify-content: space-between; width: 25%; flex-wrap: wrap;"></div>
    <script>
        document.getElementById("addBtn").addEventListener("click", 
        function () {
            var textBox = document.getElementById("ingredient");
            var item = textBox.value;
            var newBox = document.createElement("span");
            newBox.setAttribute("name", item);
            newBox.innerHTML += item;
            document.getElementById("list").appendChild(newBox);
        });
    </script>
    <form action="/searchIngredients">
        
    </form>

    <script>
            function searchIngredients() {
        // Collect the span values
        var spans = document.querySelectorAll("#list span");
        var values = Array.from(spans).map(function(span) {
        return span.innerText;
        });

        // Construct the query parameters
        var queryParams = values.map(function(value) {
        return "ingredient=" + encodeURIComponent(value);
        });

        // Build the URL with the query parameters
        var url = "/searchIngredients?" + queryParams.join("&");

        // Make a GET request to the Node.js server
        fetch(url)
        .then(function(response) {
            // Handle the response here
            // For example, you can process the data returned by the server
            // or perform any other desired actions
            console.log("GET request succeeded!");
            // return response.json(); // Assuming the server returns JSON
        })
        .then(function(data) {
            // Process the data returned by the server
            console.log(data);
        })
        .catch(function(error) {
            // Handle any errors that occur during the request
            console.log("GET request failed:", error);
        });
    }
    </script>
    <% if (recipes) { %>
        <h3>Recipes</h3>
        <% for (let i=0; i < recipes.length; i++) { %>

            <div
                class="max-w-sm p-6 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
                <a href="#">
                    <h5 class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white"><%= recipes[i].name.replace(/&quot;/g, '\"' ) %></h5>
                </a>
                <p class="mb-3 font-normal text-gray-700 dark:text-gray-400">Ingredients:
                    <ul>
                        <% for (let j=0; j < recipes[i].ingredientArray.length; j++) {%>
                            <li>
                                <%= recipes[i].ingredientArray[j]%>
                            </li>
                            <% } %>
                    </ul>
                    <p>Servings: <%= recipes[i].servings %>
                    </p>
                    <p>Prep Time: <%= times[i] %>
                    </p>
                    </p>
                <a href="/recipe?id=<%= recipes[i]._id %>&time=<%= times[i] %>"
                    class="inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    View Recipe
                    <svg aria-hidden="true" class="w-4 h-4 ml-2 -mr-1" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </a>
            </div>

            <% }} %>

            <!-- new layout starts here -->

            <div class="container mx-auto p-4">
                <!-- Dropdown Menu and Advanced Filters Button -->
                <div class="flex justify-between items-center mb-4">
                  <select class="p-2 rounded border">
                    <option value="">Select Prep Time</option>
                    <!-- Add dropdown options here -->
                  </select>
                  <button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded">Advanced Filters</button>
                </div>
                
                <!-- Search Bar with Add Button -->
                <div class="relative mt-4">
                    <input type="text" class="w-full py-2 pl-10 pr-4 rounded-lg border-gray-300 focus:outline-none focus:ring focus:border-blue-400" placeholder="Search by ingredient">
                    <button class="absolute inset-y-0 right-0 px-3 py-2 bg-blue-500 text-white rounded-r-lg focus:outline-none hover:bg-blue-600">
                      Add
                    </button>
                  </div>
                
                <!-- Ingredients List -->
                <div class="mt-4">
                    <!-- Ingredient item -->
                    <div class="flex items-center mb-2">
                      <span class="bg-blue-400 text-white py-1 px-2 rounded-full flex items-center mr-2">
                        <span class="mr-1">Ingredient Name</span>
                        <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svg="http://www.w3.org/2000/svg" class="w-4 h-4 fill-current text-white cursor-pointer" viewBox="0 0 400 400" version="1.0">
                          <g transform="translate(1173.2 38.831)">
                            <g transform="matrix(.48018 0 0 .48018 -316.23 468.11)">
                              <path style="fill:#b7bcc3" d="m-1535.3-915.12-108.68 108.68 144.8 144.74c12.426 12.426 12.426 32.479 0 44.905l-144.8 144.8 108.68 108.68 144.8-144.8c12.426-12.426 32.479-12.426 44.905 0l144.8 144.8 108.68-108.68-144.8-144.8c-12.426-12.426-12.426-32.479 0-44.905l144.8-144.74-108.68-108.68-144.8 144.74c-12.426 12.426-32.479 12.426-44.905 0l-144.8-144.74z"/>
                            </g>
                          </g>
                        </svg>
                      </span>
                      
                      <!-- Add more ingredient items -->
                      
                    </div>
                </div>
                <!-- Find Recipe Button -->
                <button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 mb-4 rounded w-full">Find Recipe</button>
                
                  <!-- Ingredient Categories -->
                  <div class="mt-8">
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                      <!-- Category 1 -->
                      <div x-data="{ open: false }">
                        <label @click="open = !open" class="cursor-pointer flex items-center">
                          <img src="category1-image.jpg" alt="Category 1" class="w-8 h-8 mr-2">
                          <h2 class="text-lg font-semibold">Fats and oils</h2>
                        </label>

                        <!-- Ingredients in Category 1 -->
                        <div x-show="open" class="mt-2 grid grid-cols-2 gap-4">
                          <!-- Ingredient item -->
                          <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 1</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 2</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 3</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 4</span>
                          </label>

                          <!-- Add more ingredient items -->
                        </div>
                      </div>

                      <!-- Category 2 -->
                      <div x-data="{ open: false }">
                        <label @click="open = !open" class="cursor-pointer flex items-center">
                          <img src="category2-image.jpg" alt="Category 2" class="w-8 h-8 mr-2">
                          <h2 class="text-lg font-semibold">Fruits</h2>
                        </label>

                        <!-- Ingredients in Category 2 -->
                        <div x-show="open" class="mt-2 grid grid-cols-2 gap-4">
                          <!-- Ingredient item -->
                          <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 1</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 2</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 3</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 4</span>
                          </label>

                          <!-- Add more ingredient items -->
                        </div>
                      </div>
                      <!-- Category 3 -->
                      <div x-data="{ open: false }">
                        <label @click="open = !open" class="cursor-pointer flex items-center">
                          <img src="category3-image.jpg" alt="Category 3" class="w-8 h-8 mr-2">
                          <h2 class="text-lg font-semibold">Meat</h2>
                        </label>

                        <!-- Ingredients in Category 2 -->
                        <div x-show="open" class="mt-2 grid grid-cols-2 gap-4">
                          <!-- Ingredient item -->
                          <label class="flex items-center">
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 1</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 2</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 3</span>
                            <input type="checkbox" class="form-checkbox text-blue-500 h-4 w-4">
                            <span class="ml-2">Ingredient Name 4</span>
                          </label>

                          <!-- Add more ingredient items -->
                        </div>
                      </div

                      <!-- Add more categories -->
                    </div>
                  </div>

                  
                  
  
  
                <!-- close container tag -->
              </div>
              
            <!-- new layout ends here -->

            <script type="module" src="/scripts/Ingredientsearch.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js" defer></script>


                <%- include('templates/footer') -%>